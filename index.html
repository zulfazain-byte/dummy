<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Favicon -->
    <link rel="icon" href="https://placehold.co/32x32/3B82F6/FFFFFF?text=A" type="image/png">
    
    <!-- Judul dan Meta Deskripsi untuk SEO -->
    <title>Percetakan Arjuna - Kemasan Modern & Interaktif</title>
    <meta name="description" content="Percetakan Arjuna Sleman, Yogyakarta. Spesialis cetak paper lunch box, rice box, dus sate, donat, martabak, dan kemasan UMKM kuliner. Desain gratis suka-suka, kualitas terjamin.">
    <meta name="keywords" content="Paper Lunch Box, Rice paper Box, Dus Sate, Dus Corndog, Dus 18x18, Dus 20x20, Dus Donat, Dus Martabak, Dus Roti Bakar, Dus Burger, Dus Kebab, Dus FNB, Dus UMKM Kuliner, Percetakan Dus Yogyakarta, Cetak Kemasan Sleman, Ivory, Kraft, Duplex, Art Paper, Kemasan Herbal, Kemasan Kosmetik">
    
    <!-- Tailwind CSS for modern styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts for creative typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

    <!-- Three.js Library for 3D Viewer -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- Post-processing and controls -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/EffectComposer.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/RenderPass.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/ShaderPass.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/shaders/CopyShader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/OutlinePass.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/shaders/FXAAShader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/shaders/DepthLimitedBlurShader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/shaders/UnpackDepthRGBAShader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/shaders/SAOShader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/SAOPass.js"></script>
    
    <style>
        /* Menggunakan font Poppins untuk seluruh halaman */
        body {
            font-family: 'Poppins', sans-serif;
            /* Mencegah penyalinan konten */
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }
        /* Animasi halus untuk scroll */
        html {
            scroll-behavior: smooth;
        }
        /* Style untuk CTA button agar lebih menonjol */
.cta-button {
    position: relative;
    overflow: hidden;
    /* Efek 3D */
    transform: perspective(1px) translateZ(0);
    /* Transisi lebih dinamis */
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    /* Menambahkan glow */
    border: 2px solid transparent;

    /* Gradien Bergerak */
    background-size: 200% auto;
    background-image: linear-gradient(to right, var(--tw-gradient-stops));
}

.cta-button:hover,
.cta-button:focus {
    /* Hover dan focus */
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.25);
    /* Efek glow saat di-hover */
    border-color: rgba(255, 255, 255, 0.5); 
    box-shadow: 0 0 8px rgba(255, 255, 255, 0.6), 0 0 15px rgba(255, 255, 255, 0.4); 
    
    /* Animasi Gradien Bergerak */
    background-position: right center;  
}

.cta-button:active {
    /* Efek saat ditekan */
    transform: translateY(0);
    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
    animation: button-pop 0.3s ease-out; /* Animasi pop-up saat diklik */
}
        
        /* --- ANIMASI RIPPLE EFFECT LEBIH CEPAT DAN HALUS --- */
.ripple {
    position: absolute;
    border-radius: 50%;
    background: radial-gradient(circle at center, rgba(255, 255, 255, 0.7) 0%, rgba(255, 255, 255, 0) 70%);
    transform: scale(0);
    animation: ripple-animation 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    pointer-events: none;
}

@keyframes ripple-animation {
    to {
        transform: scale(4);
        opacity: 0;
    }
}
        
/* --- Tambahan: Animasi Pop-Up untuk tombol itu sendiri saat di-klik --- */
@keyframes button-pop {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); } 
    100% { transform: scale(1); }
}

/* 1. Animasi pada header */
.header-animate {
    transition: transform 0.4s ease-in-out, box-shadow 0.4s ease-in-out;
}

.header-scrolled {
    transform: translateY(0);
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

/* 2. Animasi pada judul header */
.title-animate {
    transition: all 0.4s ease-in-out;
}
.title-animate:hover {
    letter-spacing: 1px;
    text-shadow: 0 0 10px rgba(59, 130, 246, 0.6);
}
.title-animate:hover .text-blue-600 {
    transform: scale(1.1) rotate(2deg);
    display: inline-block;
}

        /* 3. Style untuk Galeri Klien Interaktif */
        .client-card {
            position: relative;
            overflow: hidden;
            transform-style: preserve-3d;
            transition: transform 0.8s;
            cursor: pointer;
        }
        .client-card > div {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            backface-visibility: hidden;
            transition: transform 0.8s;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: white; 
        }
        .client-logo {
            transform: rotateY(0deg);
            z-index: 2;
        }
        .client-product {
            transform: rotateY(180deg);
            z-index: 1;
        }
        .client-card:hover .client-logo {
            transform: rotateY(-180deg);
        }
        .client-card:hover .client-product {
            transform: rotateY(0deg);
        }
        .client-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .client-logo img {
            object-fit: contain;  
            padding: 1rem; 
        }


        /* 4. Animasi pada bagian Keunggulan Kami */
        .benefit-card {
            transition: transform 0.5s ease-in-out, box-shadow 0.5s ease-in-out, border 0.5s ease-in-out;
            border: 3px solid transparent;
        }

        .benefit-card:hover {
            transform: translateY(-8px) rotate(-1deg);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
            border-color: #3b82f6;
            animation: pulsate-border 1.9s infinite ease-in-out;
        }

        @keyframes pulsate-border {
            0% { border-color: #3b82f6; }
            50% { border-color: #60a5fa; }
            100% { border-color: #3b82f6; }
        }
        .benefit-icon {
            transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            cursor: pointer; 
        }
        .benefit-card:hover .benefit-icon {
            transform: scale(1.1) rotate(5deg);
        }

        .benefit-icon.is-spinning {
            transform: rotate(360deg) scale(1.1);
        }


        /* 5. Animasi pada bagian Produk Kemasan Kami */
        .product-card {
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }
        .product-card img {
            transition: transform 0.5s ease-in-out;
        }
        .product-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }
        .product-card:hover img {
            transform: scale(1.1);
        }
        .product-card:active {
            transform: translateY(-4px) scale(1);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }

        /* 6. Animasi pada bagian Partner Terpercaya (Tentang Kami) */
        .about-card {
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }
        .about-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }
        .about-card:active {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }

        .stat-card {
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }
        .stat-card:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        .counter-value {
            font-variant-numeric: tabular-nums;
        }


        /* 7. Animasi untuk credit line di footer */
        .credit-line {
            position: relative;
            display: inline-block;
            transition: transform 0.3s ease-in-out;
        }
        .credit-line::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 1px;
            background-color: #ffffff;
            transition: width 0.3s ease-in-out;
            opacity: 0.5;
        }
        .credit-line:hover {
            transform: translateY(-2px);
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.8);
        }
        .credit-line:hover::after {
            width: 100%;
        }

        /* 8. Animasi pada hero title */
        .hero-title-highlight {
            transition: text-shadow 0.3s ease-in-out;
        }
        .hero-title-highlight:hover {
            text-shadow: 0 0 10px rgba(59, 130, 246, 0.6);
        }
        .hero-text-word {
            display: inline-block;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }

        /* 9. Animasi untuk tombol WhatsApp mengambang */
        .floating-whatsapp {
            animation: pulse-green 2s infinite cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        @keyframes pulse-green {
            0% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7);
            }
            70% {
                transform: scale(1.1);
                box-shadow: 0 0 0 15px rgba(34, 197, 94, 0);
            }
            100% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(34, 197, 94, 0);
            }
        }

        /* Animasi pada judul di setiap section */
        .section-title:hover {
            transition: color 0.3s ease-in-out;
            color: #3b82f6;
        }
        .section-subtitle:hover {
             transition: color 0.3s ease-in-out;
             color: #6b7280;
        }

        /* 10. Animasi pada bagian peta */
        .map-container {
            transition: transform 0.4s ease-in-out, box-shadow 0.4s ease-in-out;
        }

        .map-container:hover {
            transform: scale(1.02);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
        }

        .map-container:hover iframe {
            filter: grayscale(0%);
            transition: filter 0.4s ease-in-out;
        }

        /* 11. Animasi 3D untuk bagian Herbal & Kosmetik */
        .premium-card {
            transition: transform 0.6s cubic-bezier(0.2, 0.8, 0.2, 1), box-shadow 0.6s ease-in-out, border-color 0.6s ease-in-out;
            transform: translateZ(0);
            border: 2px solid transparent;
        }
        .premium-card:hover {
            transform: scale(1.05) translateY(-5px) translateZ(10px);
            box-shadow: 
                0 0 10px rgba(59, 130, 246, 0.2), 
                0 0 20px rgba(59, 130, 246, 0.1), 
                0 15px 30px rgba(0, 0, 0, 0.25);  
            border-color: #3b82f6;
        }
        .premium-card h3, .premium-card p {
            transition: transform 0.6s ease-in-out;
        }
        .premium-card:hover h3, .premium-card:hover p {
            transform: translateZ(20px);
        }
        
        .hero-image {
            width: 100%;
            height: auto;
            display: block;
        }

        /* Animasi Fade-in on Scroll (untuk stagger) */
        .fade-in-on-scroll {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .fade-in-on-scroll.is-visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* GAYA BARU UNTUK 3D MOCKUP VIEWER */
        #mockup-canvas-container {
            width: 100%;
            height: 450px;
            cursor: grab;
            border-radius: 0.75rem;
            touch-action: none;
            position: relative;
            overflow: hidden;
        }
        #mockup-canvas-container:active { cursor: grabbing; }

        .control-label {
            display: block;
            margin-bottom: 0.25rem;
            font-weight: 600;
            color: #374151;
            font-size: 0.875rem;
        }
        input[type="text"], input[type="number"], select, input[type="range"] {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            background-color: white;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        input:focus, select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.4);
        }

        .side-selector label {
            display: inline-block;
            padding: 0.5rem 1rem;
            border: 1px solid #d1d5db;
            cursor: pointer;
            transition: all 0.2s ease;
            flex-grow: 1;
            text-align: center;
        }
        .side-selector input[type="radio"]:checked + label {
            background-color: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        .side-selector input[type="radio"] { display: none; }

        /* Accordion Styles */
        .accordion-button {
            width: 100%;
            background-color: #f9fafb;
            color: #111827;
            cursor: pointer;
            padding: 1rem;
            text-align: left;
            border: none;
            border-bottom: 1px solid #e5e7eb;
            font-size: 1.125rem;
            font-weight: 700;
            transition: background-color 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .accordion-button:hover { background-color: #f3f4f6; }
        .accordion-button.active .accordion-arrow { transform: rotate(180deg); }
        .accordion-arrow { transition: transform 0.3s ease; }
        .accordion-content {
            padding: 1.5rem;
            background-color: white;
            display: none;
            border-bottom: 1px solid #e5e7eb;
            animation: slide-down 0.3s ease-out;
        }
        @keyframes slide-down {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Modals */
        .modal {
             transition: opacity 0.3s ease-in-out;
        }
        
        #ar-button {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 12px 24px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            border-radius: 999px;
            border: none;
            font-weight: bold;
            cursor: pointer;
            z-index: 999;
        }

    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- Header & Navigasi -->
    <header id="header" class="bg-white shadow-md sticky top-0 z-50 header-animate">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center max-w-7xl">
            <div class="flex items-center space-x-3">
                <!-- Logo Percetakan Arjuna -->
                <img src="https://placehold.co/48x48/3B82F6/FFFFFF?text=A" alt="Logo Percetakan Arjuna" class="h-12 w-auto">
                <a href="#" class="text-xl md:text-2xl font-bold text-gray-800 title-animate">Percetakan <span class="text-blue-600">Arjuna</span></a>
            </div>
            <!-- Navigasi Desktop -->
            <div class="hidden md:flex items-center space-x-8" id="desktop-nav">
                <a href="#produk" class="nav-link text-gray-600 hover:text-blue-600" data-section="produk">Produk</a>
                <a href="#mockup-viewer" class="nav-link text-gray-600 hover:text-blue-600" data-section="mockup-viewer">Pratinjau 3D</a>
                <a href="#tentang" class="nav-link text-gray-600 hover:text-blue-600" data-section="tentang">Tentang Kami</a>
                <a href="#kontak" class="bg-blue-600 text-white px-4 py-2 rounded-full hover:bg-blue-700 transition">Hubungi Kami</a>
            </div>
            <!-- Tombol Menu Mobile -->
            <div class="md:hidden">
                <button id="menu-btn" class="text-gray-600 hover:text-blue-600 focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
                    </svg>
                </button>
            </div>
        </nav>
        <!-- Menu Mobile -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t">
            <a href="#produk" class="block py-2 px-6 text-sm text-gray-600 hover:bg-gray-100">Produk</a>
            <a href="#mockup-viewer" class="block py-2 px-6 text-sm text-gray-600 hover:bg-gray-100">Pratinjau 3D</a>
            <a href="#tentang" class="block py-2 px-6 text-sm text-gray-600 hover:bg-gray-100">Tentang Kami</a>
            <a href="#kontak" class="block py-2 px-6 text-sm text-gray-600 hover:bg-gray-100">Hubungi Kami</a>
        </div>
    </header>

    <main>
        <!-- Image Banner Section -->
        <section class="w-full bg-white">
            <img src="https://placehold.co/1920x600/e0e7ff/334155?text=Solusi+Kemasan+Profesional" alt="Kemasan Produk Percetakan Arjuna" class="w-full h-auto hero-image">
        </section>

        <!-- Hero Section -->
        <section class="bg-white" id="hero-section">
            <div class="container mx-auto px-6 py-20 text-center max-w-7xl">
                <h1 class="text-4xl md:text-6xl font-bold text-gray-800 leading-tight" id="hero-title-container"></h1>
                <p class="mt-4 text-lg text-gray-600 max-w-3xl mx-auto">
                    Kesan pertama menentukan segalanya. Jangan biarkan produk istimewa Anda tampil biasa saja. Di Percetakan Arjuna, kami mengubah kemasan menjadi duta brand Anda. Biarkan tim desainer ahli kami merancang kemasan eksklusif sesuai visi Anda—sepenuhnya <span class="font-bold text-blue-600">GRATIS</span>. Ciptakan kemasan profesional tak terlupakan yang memikat pelanggan bahkan sebelum mereka mencicipi produk Anda.
                </p>
                <div class="mt-8 flex flex-col sm:flex-row justify-center items-center space-y-4 sm:space-y-0 sm:space-x-4">
                    <a href="https://wa.me/6282226903074?text=Halo%20Percetakan%20Arjuna,%20saya%20tertarik%20untuk%20membuat%20kemasan%20custom." target="_blank" class="cta-button w-full sm:w-auto bg-green-500 text-white px-8 py-3 rounded-full font-semibold text-lg hover:bg-green-600 from-green-400 to-green-600">
                        Konsultasi via WhatsApp
                    </a>
                    <a href="https://shopee.co.id/percetakan_arjuna?entryPoint=ShopBySearch&searchKeyword=percetakan%20arjuna" target="_blank" class="cta-button w-full sm:w-auto bg-orange-500 text-white px-8 py-3 rounded-full font-semibold text-lg hover:bg-orange-600 from-orange-400 to-orange-600">
                        Belanja di Shopee
                    </a>
                </div>
            </div>
        </section>

        <!-- Keunggulan Section -->
        <section class="py-16" id="keunggulan">
            <div class="container mx-auto px-6 max-w-7xl">
                <div class="text-center mb-12">
                     <h2 class="text-3xl md:text-4xl font-bold section-title">Keunggulan Kami</h2>
                     <p class="mt-2 text-gray-600 section-subtitle">Alasan mengapa ratusan UMKM memercayakan kemasannya kepada kami.</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 text-center" id="benefit-grid">
                    <div class="benefit-card bg-white p-8 rounded-lg shadow-lg fade-in-on-scroll" style="--stagger-delay: 0s;"><div class="bg-blue-100 text-blue-600 rounded-full h-20 w-20 flex items-center justify-center mx-auto mb-4 benefit-icon"><svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L15.232 5.232z" /></svg></div><h3 class="text-xl font-bold mb-2">Desain Suka-Suka GRATIS</h3><p class="text-gray-600">Tim desain siap membantu membuat kemasan menarik sesuai selera dan impian Anda.</p></div>
                    <div class="benefit-card bg-white p-8 rounded-lg shadow-lg fade-in-on-scroll" style="--stagger-delay: 0.1s;"><div class="bg-blue-100 text-blue-600 rounded-full h-20 w-20 flex items-center justify-center mx-auto mb-4 benefit-icon"><svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-14L4 7m0 0v10l8 4m0-14L4 7" /></svg></div><h3 class="text-xl font-bold mb-2">Bisa Cetak Jumlah Kecil</h3><p class="text-gray-600">Mulai dari 500 pcs, cocok untuk UMKM yang baru mulai merintis bisnis.</p></div>
                    <div class="benefit-card bg-white p-8 rounded-lg shadow-lg fade-in-on-scroll" style="--stagger-delay: 0.2s;"><div class="bg-blue-100 text-blue-600 rounded-full h-20 w-20 flex items-center justify-center mx-auto mb-4 benefit-icon"><svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg></div><h3 class="text-xl font-bold mb-2">Layanan Cepat</h3><p class="text-gray-600">Kami berdedikasi memberikan respons ramah dan proses cepat untuk kepuasan pelanggan.</p></div>
                    <div class="benefit-card bg-white p-8 rounded-lg shadow-lg fade-in-on-scroll" style="--stagger-delay: 0.3s;"><div class="bg-blue-100 text-blue-600 rounded-full h-20 w-20 flex items-center justify-center mx-auto mb-4 benefit-icon"><svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.085a2 2 0 00-1.915 1.915L5 10m7 0a1 1 0 001 1h3.546l-1.09 2H9m4 0C9 13 8 14 7 14c-1.21 0-2.27-.596-3-1.5" /></svg></div><h3 class="text-xl font-bold mb-2">Dukungan Penuh Untuk UMKM</h3><p class="text-gray-600">Khusus mendukung UMKM naik kelas, kami memberikan penawaran terbaik.</p></div>
                </div>
            </div>
        </section>

        <!-- Video Showcase Section -->
        <section id="video-showcase" class="py-16 sm:py-24 bg-gray-100">
            <div class="container mx-auto px-6 max-w-7xl">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold section-title">Kualitas dalam Setiap Detail</h2>
                    <p class="mt-2 text-gray-600 section-subtitle">Lihat bagaimana kami mengubah ide Anda menjadi kemasan yang sempurna.</p>
                </div>
                <div class="aspect-video rounded-lg overflow-hidden shadow-2xl fade-in-on-scroll border-4 border-white">
                    <iframe src="https://www.youtube.com/embed/Ih-62_d-d4k" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="w-full h-full"></iframe>
                </div>
            </div>
        </section>

        <!-- Produk Section -->
        <section id="produk" class="py-20 bg-white">
            <div class="container mx-auto px-6 max-w-7xl">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold section-title">Produk Kemasan Kami</h2>
                    <p class="mt-2 text-gray-600 section-subtitle">Berbagai pilihan kemasan untuk segala jenis kebutuhan bisnis Anda.</p>
                </div>
                <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-6" id="product-grid">
                    <div class="product-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-xl border border-gray-200 fade-in-on-scroll" style="--stagger-delay: 0s;"><div class="aspect-square"><img src="https://placehold.co/400x400/e2e8f0/334155?text=Lunch+Box" alt="Lunch Box" class="w-full h-full object-cover"></div><div class="p-4"><h4 class="font-semibold text-center text-gray-700">Lunch Box</h4></div></div>
                    <div class="product-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-xl border border-gray-200 fade-in-on-scroll" style="--stagger-delay: 0.05s;"><div class="aspect-square"><img src="https://placehold.co/400x400/e2e8f0/334155?text=Dus+Sate" alt="Taichan" class="w-full h-full object-cover"></div><div class="p-4"><h4 class="font-semibold text-center text-gray-700">Dus Sate</h4></div></div>
                    <div class="product-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-xl border border-gray-200 fade-in-on-scroll" style="--stagger-delay: 0.1s;"><div class="aspect-square"><img src="https://placehold.co/400x400/e2e8f0/334155?text=Dus+Brownies" alt="Brownies" class="w-full h-full object-cover"></div><div class="p-4"><h4 class="font-semibold text-center text-gray-700">Dus Brownies</h4></div></div>
                    <div class="product-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-xl border border-gray-200 fade-in-on-scroll" style="--stagger-delay: 0.15s;"><div class="aspect-square"><img src="https://placehold.co/400x400/e2e8f0/334155?text=Donut+1pcs" alt="Donut 1pcs" class="w-full h-full object-cover"></div><div class="p-4"><h4 class="font-semibold text-center text-gray-700">Donut 1pcs</h4></div></div>
                    <div class="product-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-xl border border-gray-200 fade-in-on-scroll" style="--stagger-delay: 0.2s;"><div class="aspect-square"><img src="https://placehold.co/400x400/e2e8f0/334155?text=Donut+2pcs" alt="Donut 2pcs" class="w-full h-full object-cover"></div><div class="p-4"><h4 class="font-semibold text-center text-gray-700">Donut 2pcs</h4></div></div>
                    <div class="product-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-xl border border-gray-200 fade-in-on-scroll" style="--stagger-delay: 0.25s;"><div class="aspect-square"><img src="https://placehold.co/400x400/e2e8f0/334155?text=Donut+3pcs" alt="Donut 3pcs" class="w-full h-full object-cover"></div><div class="p-4"><h4 class="font-semibold text-center text-gray-700">Donut 3pcs</h4></div></div>
                    <div class="product-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-xl border border-gray-200 fade-in-on-scroll" style="--stagger-delay: 0.3s;"><div class="aspect-square"><img src="https://placehold.co/400x400/e2e8f0/334155?text=Donut+6pcs" alt="Donut 6pcs" class="w-full h-full object-cover"></div><div class="p-4"><h4 class="font-semibold text-center text-gray-700">Donut 6pcs</h4></div></div>
                    <div class="product-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-xl border border-gray-200 fade-in-on-scroll" style="--stagger-delay: 0.35s;"><div class="aspect-square"><img src="https://placehold.co/400x400/e2e8f0/334155?text=Fried+Chicken" alt="Fried Chicken" class="w-full h-full object-cover"></div><div class="p-4"><h4 class="font-semibold text-center text-gray-700">Fried Chicken</h4></div></div>
                    <div class="product-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-xl border border-gray-200 fade-in-on-scroll" style="--stagger-delay: 0.4s;"><div class="aspect-square"><img src="https://placehold.co/400x400/e2e8f0/334155?text=Dus+Roti+Bakar" alt="Dus Roti Bakar" class="w-full h-full object-cover"></div><div class="p-4"><h4 class="font-semibold text-center text-gray-700">Dus Roti Bakar</h4></div></div>
                    <div class="product-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-xl border border-gray-200 fade-in-on-scroll" style="--stagger-delay: 0.45s;"><div class="aspect-square"><img src="https://placehold.co/400x400/e2e8f0/334155?text=Dus+Burger" alt="Dus Burger" class="w-full h-full object-cover"></div><div class="p-4"><h4 class="font-semibold text-center text-gray-700">Dus Burger</h4></div></div>
                    <div class="product-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-xl border border-gray-200 fade-in-on-scroll" style="--stagger-delay: 0.5s;"><div class="aspect-square"><img src="https://placehold.co/400x400/e2e8f0/334155?text=Dus+Kebab" alt="Dus Kebab" class="w-full h-full object-cover"></div><div class="p-4"><h4 class="font-semibold text-center text-gray-700">Dus Kebab</h4></div></div>
                    <div class="product-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-xl border border-gray-200 fade-in-on-scroll" style="--stagger-delay: 0.55s;"><div class="aspect-square"><img src="https://placehold.co/400x400/e2e8f0/334155?text=Dus+FNB" alt="Dus FNB" class="w-full h-full object-cover"></div><div class="p-4"><h4 class="font-semibold text-center text-gray-700">Dus F&B Lainnya</h4></div></div>
                </div>
            </div>
        </section>

        <!-- 3D MOCKUP VIEWER SECTION - UPDATED -->
        <section id="mockup-viewer" class="py-20 bg-gray-100">
            <div class="container mx-auto px-6 max-w-7xl">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold section-title">Studio Desain Virtual Anda</h2>
                    <p class="mt-2 text-gray-600 section-subtitle">Wujudkan ide kemasan Anda secara real-time. Atur setiap detail, tambahkan teks, dan langsung minta penawaran!</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 items-start">
                    <!-- Kontrol -->
                    <div class="md:col-span-1 bg-white rounded-lg shadow-lg overflow-hidden">
                        <!-- Accordion for controls -->
                        <div id="accordion-container">
                             <!-- Preset & Dimensi -->
                            <button class="accordion-button active">
                                <span>Ukuran & Presets</span>
                                <svg class="w-5 h-5 accordion-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </button>
                            <div class="accordion-content" style="display: block;">
                                <div class="space-y-4">
                                    <div>
                                        <label for="size-presets" class="control-label">Pilih Preset Ukuran</label>
                                        <select id="size-presets">
                                            <option value="custom">Ukuran Kustom</option>
                                            <option value="18,10,7">Lunch Box M</option>
                                            <option value="20,12,7.5">Lunch Box L</option>
                                            <option value="22,10,5">Dus Martabak</option>
                                            <option value="27,18.5,5.5">Dus Donat (Isi 6)</option>
                                        </select>
                                    </div>
                                    <div class="grid grid-cols-3 gap-4">
                                        <div><label for="custom-width" class="control-label">Panjang (cm)</label><input type="number" id="custom-width" value="20" min="5" max="50"></div>
                                        <div><label for="custom-depth" class="control-label">Lebar (cm)</label><input type="number" id="custom-depth" value="12" min="5" max="50"></div>
                                        <div><label for="custom-height" class="control-label">Tinggi (cm)</label><input type="number" id="custom-height" value="7" min="5" max="50"></div>
                                    </div>
                                </div>
                            </div>
                            <!-- Pengaturan Material -->
                             <button class="accordion-button">
                                <span>Pengaturan Material & Lingkungan</span>
                                <svg class="w-5 h-5 accordion-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </button>
                            <div class="accordion-content">
                                <div class="space-y-4">
                                    <div><label for="material-select" class="control-label">Pilih Material</label><select id="material-select"><option value="ivory">Ivory / Art Carton (Putih)</option><option value="kraft">Kraft (Coklat)</option><option value="duplex">Duplex (Abu-abu)</option></select></div>
                                    <div>
                                        <label for="finishing-select" class="control-label">Pilih Finishing (Laminasi)</label>
                                        <select id="finishing-select">
                                            <option value="standar">Standar</option>
                                            <option value="doff">Laminasi Doff (Matte)</option>
                                            <option value="glossy">Laminasi Glossy (Mengkilap)</option>
                                        </select>
                                    </div>
                                     <div class="pt-4 border-t">
                                        <label class="control-label flex items-center"><input type="checkbox" id="food-grade-lining" class="mr-2 h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500">Laminasi Dalam (Food Grade)</label>
                                    </div>
                                    <div class="pt-4 border-t">
                                        <label for="environment-select" class="control-label">Pilih Latar Belakang</label>
                                        <select id="environment-select">
                                            <option value="studio">Studio Abu-abu</option>
                                            <option value="wood">Meja Kayu</option>
                                            <option value="marble">Meja Marmer</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <!-- Pengaturan Konten -->
                             <button class="accordion-button">
                                <span>Pengaturan Konten (Logo & Teks)</span>
                                <svg class="w-5 h-5 accordion-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </button>
                            <div class="accordion-content">
                                <p class="text-sm text-gray-500 mb-4">Klik langsung pada sisi kotak di pratinjau 3D untuk memilih dan mengeditnya.</p>
                                <div class="space-y-4">
                                    <div><label class="control-label">Sisi yang Dipilih</label><select id="content-side-select" class="w-full" disabled></select></div>
                                    <div><label class="control-label">Tipe Konten</label><div class="side-selector flex rounded-md overflow-hidden"><input type="radio" id="content-type-none" name="content-type" value="none" checked><label for="content-type-none">Kosong</label><input type="radio" id="content-type-logo" name="content-type" value="logo"><label for="content-type-logo">Logo</label><input type="radio" id="content-type-text" name="content-type" value="text"><label for="content-type-text">Teks</label></div></div>
                                    <!-- Logo & Text Controls -->
                                    <div id="content-controls-container" class="hidden space-y-4 pt-4 border-t">
                                        <div class="grid grid-cols-2 gap-4">
                                            <div><label for="content-offset-x" class="control-label">Posisi X: <span id="offset-x-value">0</span>%</label><input id="content-offset-x" type="range" min="-50" max="50" step="1" value="0"></div>
                                            <div><label for="content-offset-y" class="control-label">Posisi Y: <span id="offset-y-value">0</span>%</label><input id="content-offset-y" type="range" min="-50" max="50" step="1" value="0"></div>
                                        </div>
                                        <!-- Logo Specific -->
                                        <div id="logo-controls-container" class="hidden space-y-4"><label for="logo-upload" class="w-full text-center py-2 px-4 border-2 border-dashed rounded-lg cursor-pointer hover:bg-gray-50 flex items-center justify-center"><span>Unggah Logo</span></label><input id="logo-upload" type="file" class="hidden" accept="image/png, image/jpeg"><div><label for="logo-scale-slider" class="control-label">Ukuran Logo: <span id="logo-scale-value">100</span>%</label><input id="logo-scale-slider" type="range" min="0.2" max="1.5" step="0.05" value="1.0"></div></div>
                                        <!-- Text Specific -->
                                        <div id="text-controls-container" class="hidden space-y-4">
                                            <div><label for="text-input" class="control-label">Isi Teks</label><input type="text" id="text-input" placeholder="Tuliskan Sesuatu..."></div>
                                            <button id="gemini-tagline-btn" class="w-full text-sm bg-purple-100 text-purple-700 font-semibold py-2 px-4 rounded-lg hover:bg-purple-200 transition flex items-center justify-center">
                                                ✨ Buat Tagline dengan AI
                                            </button>
                                            <div><label for="font-select" class="control-label">Jenis Huruf</label><select id="font-select"><option>Poppins</option><option>Arial</option><option>Verdana</option><option>Georgia</option><option>Times New Roman</option></select></div><div><label for="font-size-slider" class="control-label">Ukuran Huruf: <span id="font-size-value">48</span></label><input id="font-size-slider" type="range" min="16" max="128" step="1" value="48"></div></div>
                                         <!-- Premium Finish -->
                                        <div>
                                            <label for="premium-finish-select" class="control-label">Finishing Premium</label>
                                            <select id="premium-finish-select">
                                                <option value="none">Tidak Ada</option>
                                                <option value="emboss">Emboss (Timbul)</option>
                                                <option value="deboss">Deboss (Tenggelam)</option>
                                                <option value="foilEmas">Foil Emas</option>
                                                <option value="foilPerak">Foil Perak</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Pengaturan Tampilan & Warna -->
                            <button class="accordion-button">
                                <span>Tampilan & Warna</span>
                                <svg class="w-5 h-5 accordion-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </button>
                            <div class="accordion-content">
                                <div class="space-y-4">
                                    <div><label class="control-label">Warna Sisi & Teks</label><div class="grid grid-cols-2 gap-2"><div><input id="side-color-picker" type="color" value="#ffffff" class="w-full h-10 p-1 border rounded-md"><label for="side-color-picker" class="text-sm text-center block mt-1">Sisi</label></div><div><input id="text-color-picker" type="color" value="#333333" class="w-full h-10 p-1 border rounded-md"><label for="text-color-picker" class="text-sm text-center block mt-1">Teks</label></div></div></div>
                                    <div><label for="light-intensity-slider" class="control-label">Intensitas Cahaya: <span id="light-intensity-value">100</span>%</label><input id="light-intensity-slider" type="range" min="0.2" max="2.5" step="0.1" value="1.5"></div>
                                </div>
                            </div>
                        </div>
                        <!-- Tombol Aksi -->
                        <div class="p-4 bg-gray-50 space-y-2">
                             <button id="quote-button" class="w-full bg-green-600 text-white font-bold py-3 px-4 rounded-full hover:bg-green-700 transition flex items-center justify-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path d="M8 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM15 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z" /><path d="M3 4a1 1 0 00-1 1v10a1 1 0 001 1h1.05a2.5 2.5 0 014.9 0H10a1 1 0 001-1V5a1 1 0 00-1-1H3zM14 7a1 1 0 00-1 1v5.05a2.5 2.5 0 014.9 0V8a1 1 0 00-1-1h-3z" /></svg>
                                Minta Penawaran Harga
                            </button>
                            <button id="capture-button" class="w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-full hover:bg-indigo-700 transition flex items-center justify-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" /><path stroke-linecap="round" stroke-linejoin="round" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                                Ambil Gambar
                            </button>
                            <div class="grid grid-cols-2 gap-2">
                                <button id="save-button" class="w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-full hover:bg-blue-700 transition">Simpan</button>
                                <button id="reset-button" class="w-full bg-red-600 text-white font-bold py-2 px-4 rounded-full hover:bg-red-700 transition">Reset</button>
                            </div>
                        </div>
                    </div>

                    <!-- Canvas Viewer -->
                    <div class="md:col-span-2 relative">
                        <div id="mockup-canvas-container" class="shadow-inner"></div>
                         <div class="absolute top-4 right-4 flex space-x-2">
                            <button id="dieline-view-btn" class="bg-white/80 backdrop-blur-sm p-2 rounded-full shadow-md hover:bg-white transition opacity-50 cursor-not-allowed" title="Tampilan Datar (segera hadir)">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5v4m0 0h-4m4 0l-5-5" /></svg>
                            </button>
                            <button id="animate-box-btn" class="bg-white/80 backdrop-blur-sm p-2 rounded-full shadow-md hover:bg-white transition" title="Animasi Buka/Tutup">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0l7-4 7 4" /></svg>
                            </button>
                             <button id="ar-button" class="hidden bg-white/80 backdrop-blur-sm p-2 rounded-full shadow-md hover:bg-white transition" title="Lihat di Ruangan Anda (AR)">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" /></svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>


        <!-- Tentang Kami & Portofolio Section -->
        <section id="tentang" class="py-20 bg-white">
            <div class="container mx-auto px-6 max-w-7xl">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold section-title">Partner Terpercaya untuk Kemasan UMKM Anda</h2>
                    <p class="mt-2 text-gray-600 max-w-3xl mx-auto section-subtitle">Sejak 2022, Percetakan Arjuna berkomitmen menjadi solusi kemasan berkualitas bagi para pelaku UMKM kuliner. Kami percaya bahwa kemasan yang baik adalah investasi untuk meningkatkan citra brand dan kepercayaan pelanggan.</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center mb-16">
                    <div class="about-card bg-white p-8 rounded-lg shadow-lg">
                        <h3 class="text-2xl font-bold mb-4">Kualitas Material Terbaik untuk Produk Anda</h3>
                        <p class="text-gray-600 mb-4">Kami memahami setiap produk memiliki kebutuhan yang unik. Oleh karena itu, kami menyediakan beragam pilihan material premium untuk memastikan kemasan Anda tidak hanya menarik secara visual, tetapi juga fungsional dan aman.</p>
                        <ul class="space-y-2">
                            <li class="flex items-start"><svg class="h-6 w-6 text-green-500 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg><span><span class="font-semibold">Ivory & Art Carton:</span> Memberikan kesan mewah dan kokoh, ideal untuk produk premium.</span></li>
                            <li class="flex items-start"><svg class="h-6 w-6 text-green-500 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg><span><span class="font-semibold">Kraft & Duplex:</span> Pilihan ramah lingkungan dan ekonomis dengan tampilan natural yang otentik.</span></li>
                             <li class="flex items-start"><svg class="h-6 w-6 text-green-500 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg><span><span class="font-semibold">Laminasi Dalam (Food Grade):</span> Menjaga ketahanan produk dari minyak atau air, memastikan kualitas makanan tetap terjaga hingga ke tangan konsumen.</span></li>
                        </ul>
                    </div>
                    <div class="about-card grid grid-cols-2 gap-6" id="stats-section">
                          <div class="text-center bg-white p-6 rounded-lg shadow-lg stat-card"><p class="text-4xl font-bold text-blue-600 counter-value" data-target="3">0</p><p class="text-gray-600 mt-1">Tahun Pengalaman</p></div>
                          <div class="text-center bg-white p-6 rounded-lg shadow-lg stat-card"><p class="text-4xl font-bold text-blue-600 counter-value" data-target="700">0</p><p class="text-gray-600 mt-1">Klien Puas</p></div>
                          <div class="text-center bg-white p-6 rounded-lg shadow-lg col-span-2 stat-card"><p class="text-4xl font-bold text-blue-600 counter-value" data-target="9.8">0</p><p class="text-gray-600 mt-1">Rating Pelanggan</p></div>
                    </div>
                </div>

                <!-- Bagian untuk Herbal & Kosmetik -->
                <div class="text-center my-16 py-12 px-6 bg-white rounded-lg shadow-lg border border-blue-100 premium-card">
                    <h3 class="text-2xl md:text-3xl font-bold mb-4">Kemasan Premium untuk Brand Herbal & Kosmetik Anda</h3>
                    <p class="mt-4 text-gray-600 max-w-4xl mx-auto text-base md:text-lg">Di industri herbal dan kosmetik, kemasan adalah faktor penentu. Kemasan yang tepat tidak hanya melindungi produk, tetapi juga membangun <strong>kepercayaan pelanggan</strong> dan menciptakan <strong>citra brand yang kuat</strong>. Inilah yang akan membedakan produk Anda di tengah persaingan.</p>
                    <p class="mt-4 text-gray-600 max-w-4xl mx-auto text-base md:text-lg">Kami di Percetakan Arjuna menerapkan standar presisi dan kualitas tinggi untuk membantu brand Anda tampil profesional. Pilih dari material terbaik seperti <strong>Ivory</strong> dan <strong>Art Carton</strong> untuk kesan kokoh dan premium. Tambahkan sentuhan akhir yang eksklusif dengan teknik <strong>finishing</strong> seperti <span class="italic">hot foil, emboss,</span> atau <span class="italic">spot UV</span> untuk memastikan produk Anda menjadi pusat perhatian.</p>
                    <p class="mt-6 text-gray-700 max-w-4xl mx-auto text-base md:text-lg font-semibold">Mari wujudkan kemasan yang merepresentasikan kualitas produk Anda. Diskusikan ide Anda dengan kami sekarang.</p>
                </div>

                <!-- Klien Kami Section -->
                <div class="text-center mb-12">
                    <h3 class="text-2xl font-bold section-title">Klien Kami</h3>
                    <p class="mt-2 text-gray-600 section-subtitle">Kami bangga menjadi partner bagi berbagai brand untuk tumbuh bersama. Silahkan bisa klik brand untuk melihat produk kemasan Percetakan Arjuna.</p>
                </div>
                <div class="grid grid-cols-2 sm:grid-cols-4 gap-8">
                    <div class="client-card bg-white rounded-lg shadow-md aspect-square"><div class="client-logo"><img src="https://placehold.co/200x200/cccccc/333333?text=Brand+A" alt="Logo Brand Klien A"></div><div class="client-product"><img src="https://placehold.co/400x400/e0e7ff/334155?text=Produk+A" alt="Produk Brand A"></div></div>
                    <div class="client-card bg-white rounded-lg shadow-md aspect-square"><div class="client-logo"><img src="https://placehold.co/200x200/cccccc/333333?text=Brand+B" alt="Logo Brand Klien B"></div><div class="client-product"><img src="https://placehold.co/400x400/e0e7ff/334155?text=Produk+B" alt="Produk Brand B"></div></div>
                    <div class="client-card bg-white rounded-lg shadow-md aspect-square"><div class="client-logo"><img src="https://placehold.co/200x200/cccccc/333333?text=Brand+C" alt="Logo Brand Klien C"></div><div class="client-product"><img src="https://placehold.co/400x400/e0e7ff/334155?text=Produk+C" alt="Produk Brand C"></div></div>
                    <div class="client-card bg-white rounded-lg shadow-md aspect-square"><div class="client-logo"><img src="https://placehold.co/200x200/cccccc/333333?text=Brand+D" alt="Logo Brand Klien D"></div><div class="client-product"><img src="https://placehold.co/400x400/e0e7ff/334155?text=Produk+D" alt="Produk Brand D"></div></div>
                    <div class="client-card bg-white rounded-lg shadow-md aspect-square"><div class="client-logo"><img src="https://placehold.co/200x200/cccccc/333333?text=Brand+E" alt="Logo Brand Klien E"></div><div class="client-product"><img src="https://placehold.co/400x400/e0e7ff/334155?text=Produk+E" alt="Produk Brand E"></div></div>
                    <div class="client-card bg-white rounded-lg shadow-md aspect-square"><div class="client-logo"><img src="https://placehold.co/200x200/cccccc/333333?text=Brand+F" alt="Logo Brand Klien F"></div><div class="client-product"><img src="https://placehold.co/400x400/e0e7ff/334155?text=Produk+F" alt="Produk Brand F"></div></div>
                    <div class="client-card bg-white rounded-lg shadow-md aspect-square"><div class="client-logo"><img src="https://placehold.co/200x200/cccccc/333333?text=Brand+G" alt="Logo Brand Klien G"></div><div class="client-product"><img src="https://placehold.co/400x400/e0e7ff/334155?text=Produk+G" alt="Produk Brand G"></div></div>
                    <div class="client-card bg-white rounded-lg shadow-md aspect-square"><div class="client-logo"><img src="https://placehold.co/200x200/cccccc/333333?text=Brand+H" alt="Logo Brand Klien H"></div><div class="client-product"><img src="https://placehold.co/400x400/e0e7ff/334155?text=Produk+H" alt="Produk Brand H"></div></div>
                </div>
            </div>
        </section>

        <!-- Kontak & CTA Section -->
        <section id="kontak" class="bg-blue-600 text-white">
            <div class="container mx-auto px-6 py-20 text-center max-w-7xl">
                <h2 class="text-3xl md:text-4xl font-bold">Siap Meningkatkan Nilai Jual Produk Anda?</h2>
                <p class="mt-4 text-lg text-blue-100 max-w-3xl mx-auto">Kemasan bukan hanya pembungkus, tapi cerminan kualitas brand Anda. Jangan biarkan produk hebat Anda tampil biasa saja. Tim kami siap membantu Anda membuat desain yang menarik perhatian dan meningkatkan penjualan.</p>
                <div class="mt-10">
                    <p class="text-xl font-semibold text-white">Hubungi kami sekarang untuk konsultasi gratis!</p>
                    <div class="mt-6">
                        <a href="https://wa.me/6282226903074?text=Halo%20Percetakan%20Arjuna,%20saya%20ingin%20konsultasi%20mengenai%20cetak%20kemasan%20untuk%20bisnis%20saya." target="_blank" class="cta-button inline-block bg-white text-blue-600 px-8 sm:px-10 py-3 sm:py-4 rounded-full font-bold text-lg hover:bg-gray-100 from-blue-100 to-white">Chat Sekarang via WhatsApp</a>
                    </div>
                    <p class="mt-3 text-sm text-blue-200">Klik untuk langsung terhubung dengan tim kami.</p>
                </div>
            </div>
        </section>

        <!-- Google Maps Section -->
        <section id="lokasi" class="py-20 bg-white">
            <div class="container mx-auto px-6 max-w-7xl">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold section-title">Temukan Lokasi Kami</h2>
                    <p class="mt-2 text-gray-600 max-w-2xl mx-auto section-subtitle">Dusun Nglarang No.44, RT.05/RW.35, Jetis, Wedomartani, Kec. Ngemplak, Kabupaten Sleman, Daerah Istimewa Yogyakarta 55584</p>
                </div>
                <div class="overflow-hidden rounded-lg shadow-xl map-container">
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3953.284755836035!2d110.4186406758681!3d-7.75949439225708!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2e7a597352f9e5e7%3A0x819492d100bff3cb!2sPercetakan%20Arjuna!5e0!3m2!1sid!2sid" width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white">
        <div class="container mx-auto px-6 py-8 max-w-7xl">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="text-center md:text-left mb-4 md:mb-0">
                    <h3 class="text-xl font-bold">Percetakan Arjuna</h3>
                    <p class="text-gray-400">Dusun Nglarang No.44, RT.05/RW.35, Wedomartani, Ngemplak, Sleman, Yogyakarta 55584</p>
                </div>
                <div class="flex space-x-6">
                    <a href="https://wa.me/6282226903074" target="_blank" class="text-gray-400 hover:text-white">WhatsApp</a>
                    <a href="https://shopee.co.id/percetakan_arjuna?entryPoint=ShopBySearch&searchKeyword=percetakan%20arjuna" target="_blank" class="text-gray-400 hover:text-white">Shopee</a>
                    <a href="#tentang" class="text-gray-400 hover:text-white">Tentang Kami</a>
                </div>
            </div>
            <div class="mt-8 border-t border-gray-700 pt-6 text-center text-gray-500 text-sm">
                © 2025 Percetakan Arjuna. All Rights Reserved. <span class="credit-line">by Dhiya'Ulhag Zulfa Zain</span>
            </div>
        </div>
    </footer>

    <!-- Scroll to Top Button -->
    <button id="to-top-button" title="Go to top" class="hidden fixed z-50 bottom-10 right-10 p-4 border-0 w-14 h-14 rounded-full shadow-md bg-blue-600 hover:bg-blue-700 text-white text-lg font-semibold transition-all duration-300">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 15l7-7 7 7" /></svg>
    </button>

    <!-- Floating WhatsApp Button -->
    <a href="https://wa.me/6282226903074?text=Halo%20Percetakan%20Arjuna,%20saya%20tertarik%20dengan%20layanan%20Anda." target="_blank" title="Chat di WhatsApp" class="fixed z-50 bottom-10 left-10 p-4 w-16 h-16 rounded-full shadow-lg bg-green-500 hover:bg-green-600 text-white flex items-center justify-center transition-transform duration-300 hover:scale-110 floating-whatsapp">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" viewBox="0 0 24 24" fill="currentColor"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.894 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 4.315 1.731 6.086l.001.004 1.64-5.993a.536.536 0 0 1 .524-.438h.004a.532.532 0 0 1 .433.26z"/></svg>
    </a>

    <!-- Modal untuk pesan kesalahan -->
    <div id="modal-container" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-[999] hidden"><div class="bg-white p-6 rounded-lg shadow-xl text-center"><p class="text-gray-800 text-lg font-semibold mb-4">Mohon maaf, aksi penyalinan konten tidak diizinkan.</p><button id="modal-close-btn" class="bg-blue-600 text-white px-4 py-2 rounded-full hover:bg-blue-700 transition">Tutup</button></div></div>
    
    <!-- Modal untuk Load Session -->
    <div id="load-session-modal" class="hidden modal fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-[1000] opacity-0"><div class="bg-white p-8 rounded-lg shadow-2xl text-center max-w-sm mx-4"><h3 class="text-xl font-bold mb-4">Desain Ditemukan</h3><p class="text-gray-600 mb-6">Kami menemukan desain yang telah Anda simpan sebelumnya. Apakah Anda ingin melanjutkannya?</p><div class="flex justify-center space-x-4"><button id="load-yes-btn" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-full hover:bg-blue-700 transition">Ya, Lanjutkan</button><button id="load-no-btn" class="bg-gray-200 text-gray-800 font-bold py-2 px-6 rounded-full hover:bg-gray-300 transition">Mulai Baru</button></div></div></div>

    <!-- Modal untuk Minta Penawaran -->
    <div id="quote-modal" class="hidden modal fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-[1000] opacity-0">
        <div class="bg-white p-8 rounded-lg shadow-2xl max-w-lg mx-4 w-full">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-2xl font-bold">Minta Penawaran Harga</h3>
                <button id="quote-close-btn" class="text-gray-500 hover:text-gray-800 text-3xl leading-none">&times;</button>
            </div>
            <p class="text-gray-600 mb-6">Lengkapi data berikut untuk mengirimkan desain Anda langsung ke tim kami via WhatsApp.</p>
            <form id="quote-form" class="space-y-4">
                <div><label for="quote-name" class="control-label">Nama Anda</label><input type="text" id="quote-name" required class="w-full"></div>
                <div><label for="quote-whatsapp" class="control-label">No. WhatsApp (contoh: 628123456789)</label><input type="tel" id="quote-whatsapp" required class="w-full" placeholder="62..."></div>
                <div><label for="quote-quantity" class="control-label">Jumlah Pesanan (pcs)</label><select id="quote-quantity" class="w-full"><option>500</option><option>1000</option><option>2000</option><option>5000+</option></select></div>
                <button type="submit" class="w-full bg-green-600 text-white font-bold py-3 rounded-full hover:bg-green-700 transition">Kirim ke WhatsApp</button>
            </form>
        </div>
    </div>

    <!-- Gemini Tagline Modal -->
    <div id="gemini-modal" class="hidden modal fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-[1001] opacity-0">
        <div class="bg-white p-8 rounded-lg shadow-2xl max-w-lg mx-4 w-full">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-2xl font-bold">Ide Tagline dari AI</h3>
                <button id="gemini-close-btn" class="text-gray-500 hover:text-gray-800 text-3xl leading-none">&times;</button>
            </div>
            <div id="gemini-prompt-view">
                <p class="text-gray-600 mb-4">Masukkan jenis produk Anda (misal: kopi, donat, kue kering) untuk mendapatkan ide tagline.</p>
                <form id="gemini-form" class="flex space-x-2">
                    <input type="text" id="gemini-product-type" placeholder="Contoh: Kopi Gayo" required class="w-full">
                    <button type="submit" class="bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700 transition">Buat!</button>
                </form>
            </div>
            <div id="gemini-results-view" class="hidden">
                 <div id="gemini-loading" class="text-center">
                    <p class="text-gray-600">Mencari ide...</p>
                 </div>
                 <div id="gemini-results-list" class="space-y-2">
                    <!-- Results will be injected here -->
                 </div>
                 <button id="gemini-back-btn" class="mt-4 text-sm text-gray-500 hover:text-gray-800">Kembali</button>
            </div>
        </div>
    </div>

    <script>
        // --- SCRIPT UTAMA ---
        document.addEventListener('DOMContentLoaded', () => {
            // Script untuk Animasi Hero Text (Kata per Kata)
            const heroTitleContainer = document.getElementById('hero-title-container');
            if (heroTitleContainer) {
                const heroTextParts = ['Wujudkan', '<span class="text-blue-600 hero-title-highlight">Kemasan Impian</span>', 'Bisnis Anda'];
                heroTitleContainer.innerHTML = '';
                heroTextParts.forEach((part, index) => {
                    const span = document.createElement('span');
                    span.classList.add('hero-text-word');
                    span.innerHTML = part + ' ';
                    span.style.transitionDelay = `${index * 0.2}s`;
                    heroTitleContainer.appendChild(span);
                    setTimeout(() => {
                        span.style.opacity = '1';
                        span.style.transform = 'translateY(0)';
                    }, 50);
                });
            }

            // Script untuk Menu Mobile
            const menuBtn = document.getElementById('menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            if (menuBtn) menuBtn.addEventListener('click', () => mobileMenu.classList.toggle('hidden'));

            // Script untuk Header Scroll
            const header = document.getElementById('header');
            if (header) window.addEventListener('scroll', () => {
                header.classList.toggle('header-scrolled', window.scrollY > 50);
            });

            // Script untuk Tombol Scroll to Top
            const mybutton = document.getElementById("to-top-button");
            if (mybutton) {
                window.onscroll = () => {
                    mybutton.classList.toggle("hidden", document.body.scrollTop <= 100 && document.documentElement.scrollTop <= 100);
                };
                mybutton.addEventListener("click", () => window.scrollTo({top: 0, behavior: 'smooth'}));
            }
            
            // Script untuk Animasi Ripple pada CTA
            document.querySelectorAll('.cta-button').forEach(button => {
                button.addEventListener('click', function (e) {
                    this.querySelectorAll('.ripple').forEach(r => r.remove());
                    const ripple = document.createElement('span');
                    const rect = this.getBoundingClientRect();
                    ripple.style.left = `${e.clientX - rect.left}px`;
                    ripple.style.top = `${e.clientY - rect.top}px`;
                    ripple.style.width = ripple.style.height = `${Math.max(rect.width, rect.height)}px`;
                    ripple.classList.add('ripple');
                    this.appendChild(ripple);
                });
            });

            // Script untuk mencegah penyalinan konten
            const modal = document.getElementById('modal-container');
            const closeModalBtn = document.getElementById('modal-close-btn');
            if (modal) {
                const showModal = () => modal.classList.remove('hidden');
                closeModalBtn.addEventListener('click', () => modal.classList.add('hidden'));
                document.addEventListener('contextmenu', e => { e.preventDefault(); showModal(); });
                document.addEventListener('keydown', e => { if (e.ctrlKey && (e.key === 'c' || e.key === 'x')) { e.preventDefault(); showModal(); } });
            }
            
            // Animasi fade-in on scroll (untuk stagger effect)
            const faders = document.querySelectorAll('.fade-in-on-scroll');
            if (faders.length > 0) {
                const appearOnScroll = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const delay = parseFloat(entry.target.style.getPropertyValue('--stagger-delay')) || 0;
                            setTimeout(() => entry.target.classList.add('is-visible'), delay * 1000);  
                            observer.unobserve(entry.target);
                        }
                    });
                }, { threshold: 0.1 });
                faders.forEach(fader => appearOnScroll.observe(fader));
            }

            // Script untuk Animasi Counter
            const counterSection = document.getElementById('stats-section');
            if (counterSection) {
                let counterExecuted = false;
                const counterObserver = new IntersectionObserver((entries, observer) => {
                    if (entries[0].isIntersecting && !counterExecuted) {
                        document.querySelectorAll('.counter-value').forEach(el => {
                            const target = parseFloat(el.getAttribute('data-target'));
                            const isFloat = target % 1 !== 0;
                            const duration = 2000;
                            let startTimestamp = null;
                            const step = (timestamp) => {
                                if (!startTimestamp) startTimestamp = timestamp;
                                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                                let value = progress * target;
                                el.textContent = isFloat ? value.toFixed(1) : Math.floor(value);
                                if (progress < 1) window.requestAnimationFrame(step);
                                else el.textContent = isFloat ? target.toFixed(1) : target;
                            };
                            window.requestAnimationFrame(step);
                        });
                        counterExecuted = true;
                        observer.unobserve(counterSection);
                    }
                }, { threshold: 0.5 });
                counterObserver.observe(counterSection);
            }

            // Script untuk Navigasi Aktif Otomatis
            const sections = document.querySelectorAll('main section[id], #kontak');
            const navLinks = document.querySelectorAll('.nav-link');
            if (sections.length > 0) {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const sectionId = entry.target.getAttribute('id');
                            navLinks.forEach(link => {
                                link.classList.toggle('text-blue-600', link.getAttribute('data-section') === sectionId);
                                link.classList.toggle('font-semibold', link.getAttribute('data-section') === sectionId);
                                link.classList.toggle('text-gray-600', link.getAttribute('data-section') !== sectionId);
                            });
                        }
                    });
                }, { rootMargin: '0px', threshold: 0.5 });
                sections.forEach(section => observer.observe(section));
            }
            
            // Script untuk memutar ikon saat diklik
            document.querySelectorAll('.benefit-icon').forEach(icon => {
                icon.addEventListener('click', () => {
                    icon.classList.add('is-spinning');
                    setTimeout(() => icon.classList.remove('is-spinning'), 500);
                });
            });

            // Accordion Logic
            document.querySelectorAll('.accordion-button').forEach(button => {
                button.addEventListener('click', () => {
                    const content = button.nextElementSibling;
                    const isActive = button.classList.contains('active');
                    if (!isActive) {
                       button.classList.add('active');
                       content.style.display = 'block';
                    } else {
                       button.classList.remove('active');
                       content.style.display = 'none';
                    }
                });
            });

            // --- SCRIPT 3D MOCKUP VIEWER ---
            const mockupSection = document.getElementById('mockup-viewer');
            if (mockupSection && typeof THREE !== 'undefined' && typeof THREE.OrbitControls !== 'undefined') {
                const ui = { container: document.getElementById('mockup-canvas-container'), sizePresets: document.getElementById('size-presets'), customWidth: document.getElementById('custom-width'), customHeight: document.getElementById('custom-height'), customDepth: document.getElementById('custom-depth'), materialSelect: document.getElementById('material-select'), finishingSelect: document.getElementById('finishing-select'), foodGradeLining: document.getElementById('food-grade-lining'), environmentSelect: document.getElementById('environment-select'), sideColorPicker: document.getElementById('side-color-picker'), contentSideSelect: document.getElementById('content-side-select'), contentTypeRadios: document.querySelectorAll('input[name="content-type"]'), contentControls: document.getElementById('content-controls-container'), logoControls: document.getElementById('logo-controls-container'), textControls: document.getElementById('text-controls-container'), logoUpload: document.getElementById('logo-upload'), logoScaleSlider: document.getElementById('logo-scale-slider'), logoScaleValue: document.getElementById('logo-scale-value'), textInput: document.getElementById('text-input'), fontSelect: document.getElementById('font-select'), fontSizeSlider: document.getElementById('font-size-slider'), fontSizeValue: document.getElementById('font-size-value'), textColorPicker: document.getElementById('text-color-picker'), premiumFinishSelect: document.getElementById('premium-finish-select'), contentOffsetX: document.getElementById('content-offset-x'), contentOffsetY: document.getElementById('content-offset-y'), offsetXValue: document.getElementById('offset-x-value'), offsetYValue: document.getElementById('offset-y-value'), lightIntensitySlider: document.getElementById('light-intensity-slider'), lightIntensityValue: document.getElementById('light-intensity-value'), animateBoxBtn: document.getElementById('animate-box-btn'), dielineViewBtn: document.getElementById('dieline-view-btn'), captureButton: document.getElementById('capture-button'), arButton: document.getElementById('ar-button'), quoteButton: document.getElementById('quote-button'), saveButton: document.getElementById('save-button'), resetButton: document.getElementById('reset-button'), loadModal: document.getElementById('load-session-modal'), loadYesBtn: document.getElementById('load-yes-btn'), loadNoBtn: document.getElementById('load-no-btn'), quoteModal: document.getElementById('quote-modal'), quoteForm: document.getElementById('quote-form'), quoteCloseBtn: document.getElementById('quote-close-btn'), geminiModal: document.getElementById('gemini-modal'), geminiCloseBtn: document.getElementById('gemini-close-btn'), geminiTaglineBtn: document.getElementById('gemini-tagline-btn'), geminiForm: document.getElementById('gemini-form'), geminiProductType: document.getElementById('gemini-product-type'), geminiPromptView: document.getElementById('gemini-prompt-view'), geminiResultsView: document.getElementById('gemini-results-view'), geminiLoading: document.getElementById('gemini-loading'), geminiResultsList: document.getElementById('gemini-results-list'), geminiBackBtn: document.getElementById('gemini-back-btn'), };
                let scene, camera, renderer, boxGroup, controls, envMap, groundPlane, composer, outlinePass, saoPass, lidPivot;
                let textures = {};
                const sideNames = ["Tutup Atas", "Dasar", "Depan", "Belakang", "Kanan", "Kiri"];
                let boxParts = []; 
                let isDieLineView = false;
                let selectedPart = null;
                let originalCameraPos = new THREE.Vector3(2.5, 2, 4);
                let originalControlsTarget = new THREE.Vector3(0, 0, 0);
                
                const defaultState = { width: 20, height: 7, depth: 12, material: 'ivory', finishing: 'standar', foodGradeLining: false, environment: 'studio', lightIntensity: 1.5, sideProperties: sideNames.map(() => ({ color: '#ffffff', contentType: 'none', premiumFinish: 'none', logoScale: 1.0, text: 'Teks Anda', font: 'Poppins', fontSize: 48, textColor: '#333333', offsetX: 0, offsetY: 0 })) };
                let state = JSON.parse(JSON.stringify(defaultState));
                
                function init3D() {
                    scene = new THREE.Scene();
                    scene.background = new THREE.Color(0xdde2e8);
                    scene.fog = new THREE.Fog(0xdde2e8, 10, 30);

                    camera = new THREE.PerspectiveCamera(50, ui.container.clientWidth / ui.container.clientHeight, 0.1, 1000);
                    camera.position.set(2.5, 2, 4);
                    
                    renderer = new THREE.WebGLRenderer({ antialias: true, preserveDrawingBuffer: true });
                    renderer.setSize(ui.container.clientWidth, ui.container.clientHeight);
                    renderer.setPixelRatio(window.devicePixelRatio);
                    renderer.shadowMap.enabled = true;
                    renderer.shadowMap.type = THREE.PCFSoftShadowMap;
                    renderer.outputEncoding = THREE.sRGBEncoding;
                    renderer.toneMapping = THREE.ACESFilmicToneMapping;
                    ui.container.appendChild(renderer.domElement);
                    
                    controls = new THREE.OrbitControls(camera, renderer.domElement);
                    controls.enableDamping = true;
                    controls.dampingFactor = 0.05;
                    controls.minDistance = 2;
                    controls.maxDistance = 15;
                    controls.target.set(0, 0, 0);
                    
                    // --- Improved Lighting Setup ---
                    const hemiLight = new THREE.HemisphereLight(0xffffff, 0x444444, 0.6);
                    hemiLight.position.set(0, 20, 0);
                    scene.add(hemiLight);

                    const mainLight = new THREE.DirectionalLight(0xffffff, 1.0);
                    mainLight.position.set(5, 5, 5);
                    mainLight.castShadow = true;
                    mainLight.shadow.camera.top = 4; mainLight.shadow.camera.bottom = -4;
                    mainLight.shadow.camera.left = -4; mainLight.shadow.camera.right = 4;
                    mainLight.shadow.camera.near = 0.1; mainLight.shadow.camera.far = 20;
                    mainLight.shadow.mapSize.width = 2048; mainLight.shadow.mapSize.height = 2048;
                    mainLight.shadow.bias = -0.0001;
                    scene.add(mainLight);

                    const fillLight = new THREE.DirectionalLight(0xccddff, 0.4);
                    fillLight.position.set(-5, 3, -5);
                    scene.add(fillLight);
                    
                    // --- Studio Environment ---
                    groundPlane = new THREE.Mesh(
                        new THREE.PlaneGeometry(30, 30), 
                        new THREE.MeshStandardMaterial({ color: 0xc8ced5, roughness: 0.8 })
                    );
                    groundPlane.rotation.x = -Math.PI / 2;
                    groundPlane.receiveShadow = true;
                    scene.add(groundPlane);

                    const path = 'https://threejs.org/examples/textures/cube/pisa/';
                    const format = '.png';
                    const urls = [ path + 'px' + format, path + 'nx' + format, path + 'py' + format, path + 'ny' + format, path + 'pz' + format, path + 'nz' + format ];
                    envMap = new THREE.CubeTextureLoader().load(urls);
                    
                    const loader = new THREE.TextureLoader();
                    loader.setCrossOrigin(''); // Allow loading from other domains
                    textures.logo = loader.load('https://placehold.co/300x200/e2e8f0/334155?text=Logo+Anda', t => { t.encoding = THREE.sRGBEncoding; });
                    textures.wood = loader.load('https://threejs.org/examples/textures/hardwood2_diffuse.jpg', t => { t.encoding = THREE.sRGBEncoding; t.wrapS = t.wrapT = THREE.RepeatWrapping; t.repeat.set(8, 8); updateAppearance()});
                    textures.marble = loader.load('https://threejs.org/examples/textures/marble.jpg', t => { t.encoding = THREE.sRGBEncoding; t.wrapS = t.wrapT = THREE.RepeatWrapping; t.repeat.set(4, 4); updateAppearance()});
                    // Removed texture-based materials, will use color
                    textures.kraft = null; 
                    textures.duplex = null;

                    // Post-processing
                    composer = new THREE.EffectComposer(renderer);
                    const renderPass = new THREE.RenderPass(scene, camera);
                    composer.addPass(renderPass);

                    outlinePass = new THREE.OutlinePass(new THREE.Vector2(window.innerWidth, window.innerHeight), scene, camera);
                    outlinePass.edgeStrength = 5;
                    outlinePass.edgeGlow = 0.5;
                    outlinePass.edgeThickness = 1;
                    outlinePass.visibleEdgeColor.set('#3b82f6');
                    outlinePass.hiddenEdgeColor.set('#3b82f6');
                    composer.addPass(outlinePass);
                    
                    saoPass = new THREE.SAOPass(scene, camera, false, true);
                    saoPass.params.saoBias = 0.5;
                    saoPass.params.saoIntensity = 0.02;
                    saoPass.params.saoScale = 20;
                    saoPass.params.saoKernelRadius = 50;
                    composer.addPass(saoPass);

                    const effectFXAA = new THREE.ShaderPass(THREE.FXAAShader);
                    effectFXAA.uniforms['resolution'].value.set(1 / window.innerWidth, 1 / window.innerHeight);
                    composer.addPass(effectFXAA);
                    
                    generateSideSelectors();
                    checkForSavedState();
                    updateBoxModel();
                    setupEventListeners();
                    renderer.setAnimationLoop(renderLoop);
                }
                
                function generateSideSelectors() { ui.contentSideSelect.innerHTML = sideNames.map((name, i) => `<option value="${i}">${name}</option>`).join(''); }

                function createTextTexture(sideIndex, forBumpMap = false) {
                    const props = state.sideProperties[sideIndex];
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    canvas.width = 512; canvas.height = 512;
                    
                    if (!forBumpMap) {
                        // FIX: Use state.material to determine background color
                        let bgColor = props.color; // Default for ivory
                        if (state.material === 'kraft') {
                            bgColor = '#b08a5f'; // Kraft brown
                        } else if (state.material === 'duplex') {
                            bgColor = '#e0e0e0'; // Duplex grey
                        }
                        ctx.fillStyle = bgColor;
                        // END FIX
                        ctx.fillRect(0, 0, 512, 512);
                        ctx.fillStyle = props.textColor;
                    } else {
                        ctx.fillStyle = 'black'; ctx.fillRect(0,0,512,512);
                        ctx.fillStyle = 'white';
                    }
                    ctx.font = `bold ${props.fontSize}px ${props.font}`;
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(props.text, 256 + (props.offsetX/100 * 256), 256 - (props.offsetY/100 * 256));
                    const texture = new THREE.CanvasTexture(canvas);
                    texture.encoding = THREE.sRGBEncoding;
                    return texture;
                }

                function updateBoxModel() {
                    if (boxGroup) scene.remove(boxGroup);
                    boxGroup = new THREE.Group();
                    boxParts = [];
                    
                    const w = (state.width || defaultState.width) / 10;
                    const h = (state.height || defaultState.height) / 10;
                    const d = (state.depth || defaultState.depth) / 10;
                    
                    const createPart = (width, height, name) => {
                        const geo = new THREE.PlaneGeometry(width, height);
                        const mat = new THREE.MeshStandardMaterial({ envMap: envMap, side: THREE.DoubleSide });
                        const part = new THREE.Mesh(geo, mat);
                        part.name = name;
                        part.castShadow = true;
                        part.receiveShadow = true;
                        
                        part.userData.isPart = true;
                        boxParts.push(part);
                        return part;
                    };
                    
                    // Box Body
                    const bodyGroup = new THREE.Group();
                    const base = createPart(w, d, "Dasar");
                    base.rotation.x = -Math.PI / 2;
                    base.position.y = -h / 2;

                    const front = createPart(w, h, "Depan");
                    front.position.z = d / 2;

                    const back = createPart(w, h, "Belakang");
                    back.rotation.y = Math.PI;
                    back.position.z = -d / 2;

                    const left = createPart(d, h, "Kiri");
                    left.rotation.y = -Math.PI / 2;
                    left.position.x = -w / 2;
                    
                    const right = createPart(d, h, "Kanan");
                    right.rotation.y = Math.PI / 2;
                    right.position.x = w / 2;

                    bodyGroup.add(base, front, back, left, right);
                    
                    // Lid
                    const lid = createPart(w, d, "Tutup Atas");
                    lid.rotation.x = Math.PI/2;

                    // Lid Pivot (Hinge)
                    lidPivot = new THREE.Group();
                    lidPivot.add(lid);
                    lid.position.z = d / 2; // Move lid forward so it pivots on its back edge
                    
                    lidPivot.position.y = h / 2;      // Position the pivot at the top
                    lidPivot.position.z = -d / 2;     // Position the pivot at the back
                    
                    boxGroup.add(bodyGroup, lidPivot);
                    boxGroup.position.y = h / 2 + 0.001; // Lift the entire box to sit on the ground and avoid z-fighting
                    controls.target.set(0, h / 2, 0);

                    // Simpan posisi & rotasi original
                    boxParts.forEach(part => {
                        part.userData.originalPos = part.position.clone();
                        part.userData.originalRot = part.rotation.clone();
                        part.userData.originalParent = part.parent;
                    });
                    
                    scene.add(boxGroup);
                    updateAppearance();
                }
                
                function updateAppearance() {
                    if (!boxGroup) return;

                    const roughnessValues = { glossy: 0.05, doff: 1.0, standar: 0.6 };
                    const roughness = roughnessValues[state.finishing];
                    const envMapIntensity = state.finishing === 'glossy' ? 1.2 : state.finishing === 'standar' ? 0.6 : 0.2;
                    
                    // Update environment
                    if(state.environment === 'studio') {
                        groundPlane.material.color.set(0xc8ced5);
                        groundPlane.material.map = null;
                        scene.background = new THREE.Color(0xdde2e8);
                    } else {
                        groundPlane.material.map = textures[state.environment];
                        groundPlane.material.color.set(0xffffff); // Use texture's color
                        scene.background = envMap;
                    }
                    groundPlane.material.needsUpdate = true;

                    boxParts.forEach(part => {
                        const sideIndex = sideNames.indexOf(part.name);
                        if (sideIndex === -1) return;
                        
                        const material = part.material;
                        const sideProps = state.sideProperties[sideIndex];
                        
                        material.side = THREE.DoubleSide; // Ensure it's always double-sided

                        let baseMap = null;
                        let baseColor = sideProps.color; // Default for ivory '#ffffff'

                        if (state.material === 'kraft') {
                            baseColor = '#b08a5f'; // Kraft brown color
                        } else if (state.material === 'duplex') {
                            baseColor = '#e0e0e0'; // Duplex grey color
                        }
                        
                        let contentTexture = null;
                        if (sideProps.contentType === 'logo') {
                            contentTexture = textures.logo.clone();
                            contentTexture.needsUpdate = true;
                            contentTexture.repeat.set(1 / sideProps.logoScale, 1 / sideProps.logoScale);
                            contentTexture.offset.set(((1 - (1/sideProps.logoScale)) / 2) - (sideProps.offsetX/100), ((1 - (1/sideProps.logoScale)) / 2) + (sideProps.offsetY/100));
                        } else if (sideProps.contentType === 'text') {
                            contentTexture = createTextTexture(sideIndex);
                        }

                        material.map = contentTexture; // Set map (null if no content)
                        material.color.set(contentTexture ? 0xffffff : baseColor); // Use baseColor if no map, otherwise tint map with white
                        
                        if(part.children.length > 0 && part.children[0].material) {
                            part.children[0].visible = state.foodGradeLining;
                            part.children[0].material.needsUpdate = true;
                        }

                        material.bumpMap = null; material.bumpScale = 0.01; material.metalness = 0;
                        material.envMapIntensity = envMapIntensity;
                        
                        if(sideProps.contentType !== 'none' && (sideProps.premiumFinish === 'emboss' || sideProps.premiumFinish === 'deboss')){
                            material.bumpMap = (sideProps.contentType === 'logo') ? textures.logo : createTextTexture(sideIndex, true);
                            material.bumpScale = sideProps.premiumFinish === 'emboss' ? 0.015 : -0.015;
                        } else if (sideProps.premiumFinish.startsWith('foil')){
                            material.metalness = 1.0;
                            material.roughness = 0.15;
                            material.color.set(sideProps.premiumFinish === 'foilEmas' ? '#FFD700' : '#C0C0C0');
                            material.map = null; // Foil overrides other textures
                        }
                        
                        if(!sideProps.premiumFinish.startsWith('foil')) {
                            material.roughness = roughness;
                        }
                        
                        material.needsUpdate = true;
                    });
                }
                
                function animateBox(open = true) {
                    const targetRotation = open ? -Math.PI * (5/6) : 0;
                    const initialRotation = lidPivot.rotation.x;
                    animateValue(initialRotation, targetRotation, 1200, (val) => { lidPivot.rotation.x = val; });
                }

                function animateValue(start, end, duration, updateCallback) {
                    let startTime = null;
                    function step(timestamp) {
                        if (!startTime) startTime = timestamp;
                        const progress = Math.min((timestamp - startTime) / duration, 1);
                        const easedProgress = 0.5 * (1 - Math.cos(progress * Math.PI));
                        
                        let currentValue;
                        if (start instanceof THREE.Vector3) {
                            currentValue = new THREE.Vector3().lerpVectors(start, end, easedProgress);
                        } else if (start instanceof THREE.Quaternion) {
                            currentValue = new THREE.Quaternion().slerpQuaternions(start, end, easedProgress);
                        } else {
                            currentValue = start + (end - start) * easedProgress;
                        }
                        
                        updateCallback(currentValue);
                        if (progress < 1) requestAnimationFrame(step);
                    }
                    requestAnimationFrame(step);
                }

                function setupEventListeners() {
                    ui.sizePresets.addEventListener('change', e => {
                       if (e.target.value === 'custom') return;
                       const [w,d,h] = e.target.value.split(',').map(parseFloat);
                       state.width = w; state.depth = d; state.height = h;
                       updateUIFromState();
                       updateBoxModel();
                    });
                    
                    ['customWidth', 'customHeight', 'customDepth', 'materialSelect', 'finishingSelect', 'environmentSelect', 'foodGradeLining'].forEach(id => {
                        const el = ui[id];
                        const eventType = el.type === 'checkbox' ? 'change' : (el.tagName === 'SELECT' ? 'change' : 'input');
                        el.addEventListener(eventType, e => { 
                            let propName = id;
                            let value = el.type === 'checkbox' ? e.target.checked : e.target.value;
                            if (id.startsWith('custom')) {
                                propName = id.replace('custom','').toLowerCase();
                                value = parseFloat(value) || defaultState[propName];
                            } else if (id.endsWith('Select')) {
                                propName = id.replace('Select','');
                            }
                            state[propName] = value;
                            
                            if (e.target.id === 'materialSelect') {
                                // Update colors for all sides if material changes
                                const newColor = (value === 'ivory') ? '#ffffff' : (value === 'kraft' ? '#b08a5f' : '#e0e0e0');
                                state.sideProperties.forEach(prop => prop.color = newColor);
                                updateUIFromState();
                            }

                            if (id.startsWith('custom')) updateBoxModel();
                            else updateAppearance();
                        });
                    });

                    ui.lightIntensitySlider.addEventListener('input', e => { 
                        const intensity = parseFloat(e.target.value);
                        state.lightIntensity = intensity;
                        scene.traverse(obj => { if (obj.isLight) obj.intensity = (obj.isHemisphereLight ? 0.6 : 1.0) * intensity; });
                        ui.lightIntensityValue.textContent = Math.round(state.lightIntensity / 2.5 * 100); 
                    });
                    ui.contentSideSelect.addEventListener('change', updateUIFromState);
                    ui.sideColorPicker.addEventListener('input', e => { if(state.material === 'ivory'){ state.sideProperties[parseInt(ui.contentSideSelect.value)].color = e.target.value; updateAppearance(); } });
                    ui.contentTypeRadios.forEach(radio => radio.addEventListener('change', e => { state.sideProperties[parseInt(ui.contentSideSelect.value)].contentType = e.target.value; updateUIFromState(); updateAppearance(); }));
                    
                    ['logoScaleSlider', 'contentOffsetX', 'contentOffsetY', 'premiumFinishSelect'].forEach(id => {
                        const eventType = id.includes('Select') ? 'change' : 'input';
                        ui[id].addEventListener(eventType, e => { 
                            const side = state.sideProperties[parseInt(ui.contentSideSelect.value)]; 
                            if(id === 'logoScaleSlider') side.logoScale = parseFloat(e.target.value); 
                            else if(id === 'contentOffsetX') side.offsetX = parseInt(e.target.value); 
                            else if (id === 'premiumFinishSelect') side.premiumFinish = e.target.value; 
                            else side.offsetY = parseInt(e.target.value); 
                            updateUIFromState(); updateAppearance(); 
                        });
                    });
                    ui.logoUpload.addEventListener('change', e => { if(e.target.files[0]) { const reader = new FileReader(); reader.onload = res => { textures.logo.dispose(); textures.logo = new THREE.TextureLoader().load(res.target.result, updateAppearance); }; reader.readAsDataURL(e.target.files[0]); } });
                    
                    ['textInput', 'fontSelect', 'fontSizeSlider', 'textColorPicker'].forEach(id => {
                        const eventType = (id === 'textInput' || id.includes('Slider')) ? 'input' : 'change';
                        ui[id].addEventListener(eventType, e => { 
                            const side = state.sideProperties[parseInt(ui.contentSideSelect.value)]; 
                            if(id === 'textInput') side.text = e.target.value; 
                            else if(id === 'fontSelect') side.font = e.target.value; 
                            else if(id === 'fontSizeSlider') side.fontSize = parseInt(e.target.value); 
                            else side.textColor = e.target.value; 
                            updateUIFromState(); updateAppearance(); 
                        });
                    });
                    
                    let boxOpen = false; ui.animateBoxBtn.addEventListener('click', () => { boxOpen = !boxOpen; animateBox(boxOpen); });
                    
                    ui.dielineViewBtn.addEventListener('click', toggleDieLineView); // Re-enabled this button

                    ui.captureButton.addEventListener('click', captureScreenshot);
                    ui.saveButton.addEventListener('click', saveState);
                    ui.resetButton.addEventListener('click', resetState);
                    ui.loadYesBtn.addEventListener('click', () => { loadState(JSON.parse(localStorage.getItem('arjunaMockupDesign'))); ui.loadModal.classList.add('opacity-0', 'hidden'); });
                    ui.loadNoBtn.addEventListener('click', () => ui.loadModal.classList.add('opacity-0', 'hidden'));
                    ui.quoteButton.addEventListener('click', () => { ui.quoteModal.classList.remove('hidden'); setTimeout(() => ui.quoteModal.classList.remove('opacity-0'), 10); });
                    ui.quoteCloseBtn.addEventListener('click', () => ui.quoteModal.classList.add('opacity-0', 'hidden'));
                    ui.quoteForm.addEventListener('submit', handleQuoteSubmit);
                    
                    window.addEventListener('resize', () => { 
                        const width = ui.container.clientWidth;
                        const height = ui.container.clientHeight;
                        camera.aspect = width / height; 
                        camera.updateProjectionMatrix(); 
                        renderer.setSize(width, height);
                        composer.setSize(width, height);
                        const pixelRatio = renderer.getPixelRatio();
                        const effectFXAA = composer.passes[composer.passes.length -1];
                        effectFXAA.uniforms['resolution'].value.set(1 / (width * pixelRatio), 1 / (height * pixelRatio));
                    });
                    ui.container.addEventListener('mousedown', onCanvasClick);
                }

                function onCanvasClick(event) {
                    controls.autoRotate = false; // Stop autorotate on user interaction
                    const raycaster = new THREE.Raycaster();
                    const mouse = new THREE.Vector2();
                    const rect = renderer.domElement.getBoundingClientRect();
                    mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
                    mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
                    raycaster.setFromCamera(mouse, camera);
                    const intersects = raycaster.intersectObjects(boxParts, false);

                    if (intersects.length > 0) {
                        const selectedObject = intersects[0].object;

                        if (selectedObject.userData.isPart) {
                            selectedPart = selectedObject;
                            outlinePass.selectedObjects = [selectedPart];
                            const sideIndex = sideNames.indexOf(selectedPart.name);
                            if (sideIndex > -1) {
                                ui.contentSideSelect.value = sideIndex;
                                updateUIFromState();
                                const contentAccordionBtn = document.querySelector('#accordion-container button:nth-of-type(3)');
                                if(contentAccordionBtn && !contentAccordionBtn.classList.contains('active')) {
                                    contentAccordionBtn.click();
                                }
                            }
                        } else {
                           selectedPart = null;
                           outlinePass.selectedObjects = [];
                        }
                    } else {
                        selectedPart = null;
                        outlinePass.selectedObjects = [];
                    }
                }
                
                function toggleDieLineView() {
                    isDieLineView = !isDieLineView;
                    controls.enabled = !isDieLineView;

                    const w = (state.width || defaultState.width) / 10;
                    const h = (state.height || defaultState.height) / 10;
                    const d = (state.depth || defaultState.depth) / 10;
                    
                    const duration = 1000;
                    
                    const partMap = {};
                    boxParts.forEach(p => partMap[p.name] = p);

                    if (isDieLineView) {
                        // Simpan posisi kamera saat ini
                        originalCameraPos.copy(camera.position);
                        originalControlsTarget.copy(controls.target);

                        // Target Dieline positions & rotations
                        const targets = {
                            "Dasar": { pos: new THREE.Vector3(0, 0, 0), rot: new THREE.Quaternion().setFromEuler(new THREE.Euler(0, 0, 0)) },
                            "Depan": { pos: new THREE.Vector3(0, d/2 + h/2, 0), rot: new THREE.Quaternion().setFromEuler(new THREE.Euler(0, 0, 0)) },
                            "Belakang": { pos: new THREE.Vector3(0, -(d/2 + h/2), 0), rot: new THREE.Quaternion().setFromEuler(new THREE.Euler(0, 0, Math.PI)) },
                            "Kiri": { pos: new THREE.Vector3(-(w/2 + d/2), 0, 0), rot: new THREE.Quaternion().setFromEuler(new THREE.Euler(0, 0, 0)) },
                            "Kanan": { pos: new THREE.Vector3(w/2 + d/2, 0, 0), rot: new THREE.Quaternion().setFromEuler(new THREE.Euler(0, 0, 0)) },
                            "Tutup Atas": { pos: new THREE.Vector3(0, d/2 + h + d/2, 0), rot: new THREE.Quaternion().setFromEuler(new THREE.Euler(0, 0, 0)) },
                        };

                        // Lepas dari parent group
                        boxParts.forEach(part => {
                            if (!part.userData.originalPos) { // Simpan jika belum ada
                                part.userData.originalPos = part.position.clone();
                                part.userData.originalRot = part.rotation.clone();
                                part.userData.originalQuat = part.quaternion.clone();
                                part.userData.originalParent = part.parent;
                            }
                            
                            // Ambil world position/rotation before dilepas
                            const worldPos = new THREE.Vector3();
                            const worldQuat = new THREE.Quaternion();
                            part.getWorldPosition(worldPos);
                            part.getWorldQuaternion(worldQuat);

                            // --- FIX 1: SIMPAN WORLD POS/ROT ---
                            // Simpan posisi ini untuk animasi kembali
                            part.userData.originalWorldPos = worldPos.clone();
                            part.userData.originalWorldQuat = worldQuat.clone();
                            // --- AKHIR FIX 1 ---
                            
                            scene.attach(part); // Lepas dari parent
                            
                            // Set ke world pos/rot
          _200c               part.position.copy(worldPos);
                            part.quaternion.copy(worldQuat);

                            const t = targets[part.name];
                            animateValue(part.position.clone(), t.pos, duration, (v) => part.position.copy(v));
                            animateValue(part.quaternion.clone(), t.rot, duration, (q) => part.quaternion.copy(q));
                        });

                        // Pindahkan kamera
              _200c       animateValue(camera.position.clone(), new THREE.Vector3(0, 0, 4), duration, (v) => camera.position.copy(v));
                        animateValue(controls.target.clone(), new THREE.Vector3(0, 0, 0), duration, (v) => controls.target.copy(v));

                    } else { // Kembali ke 3D
                        boxParts.forEach(part => {
                            // Animate back to the saved world position/quaternion
                            animateValue(part.position.clone(), part.userData.originalWorldPos, duration, (v) => part.position.copy(v));
S                           animateValue(part.quaternion.clone(), part.userData.originalWorldQuat, duration, (q) => part.quaternion.copy(q));
                        });
                        
                        // Kembalikan kamera
                        animateValue(camera.position.clone(), originalCameraPos, duration, (v) => camera.position.copy(v));
                        animateValue(controls.target.clone(), originalControlsTarget, duration, (v) => controls.target.copy(v));

                        // Pasang kembali ke parent setelah animasi
                        setTimeout(() => {
                            boxParts.forEach(part => {
                                part.userData.originalParent.attach(part); // Pasang kembali ke parent
                                
                                // Set local pos/rot
                                part.position.copy(part.userData.originalPos);
                                
                                // --- FIX 2: Gunakan Quaternion ---
                                part.quaternion.copy(part.userData.originalQuat);
                                // --- AKHIR FIX 2 ---
    _200c                     });
                        }, duration);
              _200c }
                }

                        // Lepas dari parent group
                        boxParts.forEach(part => {
                            if (!part.userData.originalPos) { // Simpan jika belum ada
                                part.userData.originalPos = part.position.clone();
                                part.userData.originalRot = part.rotation.clone();
                                part.userData.originalQuat = part.quaternion.clone();
                                part.userData.originalParent = part.parent;
                            }
                            
                            // Ambil world position/rotation sebelum dilepas
                            const worldPos = new THREE.Vector3();
                            const worldQuat = new THREE.Quaternion();
                            part.getWorldPosition(worldPos);
                            part.getWorldQuaternion(worldQuat);
                            
                            scene.attach(part); // Lepas dari parent
                            
                            // Set ke world pos/rot
                            part.position.copy(worldPos);
                            part.quaternion.copy(worldQuat);

                            const t = targets[part.name];
                            animateValue(part.position.clone(), t.pos, duration, (v) => part.position.copy(v));
                            animateValue(part.quaternion.clone(), t.rot, duration, (q) => part.quaternion.copy(q));
                        });

                        // Pindahkan kamera
                        animateValue(camera.position.clone(), new THREE.Vector3(0, 0, 4), duration, (v) => camera.position.copy(v));
                        animateValue(controls.target.clone(), new THREE.Vector3(0, 0, 0), duration, (v) => controls.target.copy(v));

                    } else { // Kembali ke 3D
                        boxParts.forEach(part => {
                            const t = targets[part.name];
                            animateValue(part.position.clone(), part.userData.originalWorldPos, duration, (v) => part.position.copy(v));
                            animateValue(part.quaternion.clone(), part.userData.originalWorldQuat, duration, (q) => part.quaternion.copy(q));
                        });
                        
                        // Kembalikan kamera
                        animateValue(camera.position.clone(), originalCameraPos, duration, (v) => camera.position.copy(v));
                        animateValue(controls.target.clone(), originalControlsTarget, duration, (v) => controls.target.copy(v));

                        // Pasang kembali ke parent setelah animasi
                        setTimeout(() => {
                            boxParts.forEach(part => {
                                part.userData.originalParent.attach(part); // Pasang kembali ke parent
                                // Set local pos/rot
                                part.position.copy(part.userData.originalPos);
                                part.rotation.copy(part.userData.originalRot);
                            });
                        }, duration);
                    }
                }
                
                function captureScreenshot() {
                    outlinePass.selectedObjects = []; // Hide outline for screenshot
                    composer.render(); // Render once without outline
                    const dataURL = renderer.domElement.toDataURL('image/png');
                    const link = document.createElement('a');
                    link.href = dataURL;
                    link.download = 'desain-kemasan-arjuna.png';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    if(selectedPart) {
                        outlinePass.selectedObjects = [selectedPart]; // Restore outline
                    }
                }

                function handleQuoteSubmit(e) {
                    e.preventDefault();
                    const name = ui.quoteForm.querySelector('#quote-name').value;
                    const wa = ui.quoteForm.querySelector('#quote-whatsapp').value;
                    const qty = ui.quoteForm.querySelector('#quote-quantity').value;
                    let specSummary = `Dimensi: ${state.width}x${state.depth}x${state.height} cm, Material: ${state.material}, Laminasi: ${state.finishing}, Jumlah: ${qty} pcs.`;
                    state.sideProperties.forEach((p, i) => { if (p.contentType !== 'none') specSummary += ` | Sisi ${sideNames[i]}: ${p.contentType} (${p.contentType==='text' ? p.text : 'logo'})` + (p.premiumFinish !== 'none' ? `, Finishing: ${p.premiumFinish}`: ''); });
                    const message = encodeURIComponent(`Halo Percetakan Arjuna, saya ${name} (${wa}) tertarik untuk membuat kemasan dengan spesifikasi berikut:\n\n${specSummary}\n\nMohon info penawaran harganya. Terima kasih.`);
                    window.open(`https://wa.me/6282226903074?text=${message}`, '_blank');
                    ui.quoteModal.classList.add('opacity-0', 'hidden');
                }
                
                function renderLoop() {
                    controls.update();
                    composer.render();
                }

                function updateUIFromState() {
                    ui.customWidth.value = state.width; ui.customHeight.value = state.height; ui.customDepth.value = state.depth; ui.materialSelect.value = state.material; ui.finishingSelect.value = state.finishing; ui.lightIntensitySlider.value = state.lightIntensity; ui.lightIntensityValue.textContent = Math.round(state.lightIntensity / 2.5 * 100);
                    ui.foodGradeLining.checked = state.foodGradeLining;
                    ui.environmentSelect.value = state.environment;

                    const sideProps = state.sideProperties[parseInt(ui.contentSideSelect.value)];
                    ui.sideColorPicker.value = sideProps.color;
                    ui.sideColorPicker.disabled = state.material !== 'ivory'; // Disable color picker if not ivory

                    document.querySelector(`input[name="content-type"][value="${sideProps.contentType}"]`).checked = true;
                    
                    const showContentControls = ui.contentSideSelect.value !== '' && sideNames.includes(sideNames[parseInt(ui.contentSideSelect.value)] );
                    ui.contentControls.classList.toggle('hidden', !showContentControls);
                    if(showContentControls){
                        ui.logoControls.classList.toggle('hidden', sideProps.contentType !== 'logo');
                        ui.textControls.classList.toggle('hidden', sideProps.contentType !== 'text');
                        ui.contentOffsetX.value = sideProps.offsetX; ui.offsetXValue.textContent = sideProps.offsetX;
                        ui.contentOffsetY.value = sideProps.offsetY; ui.offsetYValue.textContent = sideProps.offsetY;
                        ui.premiumFinishSelect.value = sideProps.premiumFinish;

                        if (sideProps.contentType === 'logo') { ui.logoScaleSlider.value = sideProps.logoScale; ui.logoScaleValue.textContent = Math.round(sideProps.logoScale * 100); } 
                        else if (sideProps.contentType === 'text') { ui.textInput.value = sideProps.text; ui.fontSelect.value = sideProps.font; ui.fontSizeSlider.value = sideProps.fontSize; ui.fontSizeValue.textContent = sideProps.fontSize; ui.textColorPicker.value = sideProps.textColor; }
                    }
                }

                function saveState() { localStorage.setItem('arjunaMockupDesign', JSON.stringify(state)); alert('Desain Anda telah disimpan di browser ini!'); }
                function loadState(saved) { state = saved; updateUIFromState(); updateBoxModel(); }
                function checkForSavedState() { if (localStorage.getItem('arjunaMockupDesign')) { ui.loadModal.classList.remove('hidden'); setTimeout(() => ui.loadModal.classList.remove('opacity-0'), 10); } }
                function resetState() { if(confirm("Yakin ingin mereset semua kustomisasi?")){ localStorage.removeItem('arjunaMockupDesign'); selectedPart = null; outlinePass.selectedObjects = []; state = JSON.parse(JSON.stringify(defaultState)); ui.contentSideSelect.value = 0; updateUIFromState(); updateBoxModel(); } }
                
                // --- Gemini AI Functions ---
                const geminiModal = document.getElementById('gemini-modal');
                const geminiCloseBtn = document.getElementById('gemini-close-btn');
                const geminiTaglineBtn = document.getElementById('gemini-tagline-btn');
                const geminiForm = document.getElementById('gemini-form');
                const geminiProductType = document.getElementById('gemini-product-type');
                const geminiPromptView = document.getElementById('gemini-prompt-view');
                const geminiResultsView = document.getElementById('gemini-results-view');
                const geminiLoading = document.getElementById('gemini-loading');
                const geminiResultsList = document.getElementById('gemini-results-list');
                const geminiBackBtn = document.getElementById('gemini-back-btn');

                geminiTaglineBtn.addEventListener('click', () => {
                    geminiModal.classList.remove('hidden');
                    setTimeout(() => geminiModal.classList.remove('opacity-0'), 10);
                });
                
                const closeGeminiModal = () => {
                    geminiModal.classList.add('opacity-0');
                    setTimeout(() => {
                        geminiModal.classList.add('hidden');
                        geminiPromptView.classList.remove('hidden');
                        geminiResultsView.classList.add('hidden');
                        geminiResultsList.innerHTML = '';
                    }, 300);
                }
                geminiCloseBtn.addEventListener('click', closeGeminiModal);
                geminiBackBtn.addEventListener('click', () => {
                     geminiPromptView.classList.remove('hidden');
                     geminiResultsView.classList.add('hidden');
                     geminiResultsList.innerHTML = '';
                });

                geminiForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const productType = geminiProductType.value;
                    if (!productType) return;

                    geminiPromptView.classList.add('hidden');
                    geminiResultsView.classList.remove('hidden');
                    geminiLoading.classList.remove('hidden');
                    geminiResultsList.innerHTML = '';

                    const userQuery = `Buatkan 5 ide tagline yang singkat dan menarik untuk kemasan produk "${productType}".`;
                    const systemPrompt = `Anda adalah seorang ahli branding yang kreatif, spesialisasinya adalah membuat tagline pendek (3-5 kata) untuk kemasan produk UMKM. Berikan 5 ide.`;
                    
                    try {
                        const response = await callGeminiAPI(userQuery, systemPrompt);
                        displayGeminiResults(response.text);
                    } catch (error) {
                        console.error('Error calling Gemini API:', error);
                        displayGeminiResults("Maaf, terjadi kesalahan saat mengambil ide tagline. Coba lagi nanti.");
                    }
                });
                
                function displayGeminiResults(text) {
                    geminiLoading.classList.add('hidden');
                    const lines = text.split('\n').filter(line => line.trim().length > 0);
                    lines.forEach(line => {
                        const tagline = line.replace(/^\d+\.\s*/, '').replace(/"/g, '').trim();
                        const p = document.createElement('p');
                        p.textContent = tagline;
                        p.className = "cursor-pointer p-2 hover:bg-gray-100 rounded";
                        p.onclick = () => {
                            ui.textInput.value = tagline;
                            // Trigger input event to update 3D model
                            ui.textInput.dispatchEvent(new Event('input', { bubbles: true }));
                            closeGeminiModal();
                        };
                        geminiResultsList.appendChild(p);
                    });
                }
                
                async function callGeminiAPI(userQuery, systemPrompt, retries = 3, delay = 1000) {
                    const apiKey = ""; // API key will be injected
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

                    const payload = {
                        contents: [{ parts: [{ text: userQuery }] }],
                        systemInstruction: {
                            parts: [{ text: systemPrompt }]
                        },
                    };
                    
                    try {
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (!response.ok) {
                            if (response.status === 429 && retries > 0) {
                                await new Promise(res => setTimeout(res, delay));
                                return callGeminiAPI(userQuery, systemPrompt, retries - 1, delay * 2);
                            }
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }

                        const result = await response.json();
                        const candidate = result.candidates?.[0];
                        if (candidate && candidate.content?.parts?.[0]?.text) {
                            return { text: candidate.content.parts[0].text };
                        } else {
                            throw new Error('Invalid response structure from Gemini API');
                        }
                    } catch (error) {
                        if (retries > 0) {
                            await new Promise(res => setTimeout(res, delay));
                            return callGeminiAPI(userQuery, systemPrompt, retries - 1, delay * 2);
                        }
                        console.error('Error after retries:', error);
                        throw error;
                    }
                }
                
                init3D();
            }
        });
    </script>
</body>
</html>
